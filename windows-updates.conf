# Windows Updates monitoring via UserParameters (PowerShell script).
# Place the script at: C:\Program Files\Zabbix Agent 2\scripts\windows-updates.ps1
# Keys return integers only. If PSWindowsUpdate is missing/unavailable, counters return -1.
# Reboot flag returns 0/1 and does not depend on PSWindowsUpdate.

Timeout=30

UserParameter=win.updates.all,powershell -NoProfile -ExecutionPolicy Bypass -File "C:\Program Files\Zabbix Agent 2\scripts\windows-updates.ps1" -Mode All
UserParameter=win.updates.security,powershell -NoProfile -ExecutionPolicy Bypass -File "C:\Program Files\Zabbix Agent 2\scripts\windows-updates.ps1" -Mode Security
UserParameter=win.updates.nonsec,powershell -NoProfile -ExecutionPolicy Bypass -File "C:\Program Files\Zabbix Agent 2\scripts\windows-updates.ps1" -Mode NonSecurity
UserParameter=win.reboot,powershell -NoProfile -ExecutionPolicy Bypass -File "C:\Program Files\Zabbix Agent 2\scripts\windows-updates.ps1" -Mode Reboot